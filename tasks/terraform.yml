- name: Check terrform version
  changed_when: (terraform_version.rc != 0) or
                (terraform_expected not in terraform_version.stdout)
  failed_when: false
  register: terraform_version
  command: terraform -v

- name: Install terraform
  become: true
  when: terraform_version is changed
  unarchive:
    dest: /usr/bin
    mode: "755"
    remote_src: true
    src: "https://releases.hashicorp.com/terraform/{{ terraform_expected }}/terraform_{{ terraform_expected }}_linux_amd64.zip"
